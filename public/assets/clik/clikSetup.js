function toggleSelected(e,i){e.hasClass("selected")?$("."+i).prop("checked",!1):$("."+i).prop("checked",!0),e.toggleClass("selected")}function checkDensity(){$("#manualScale").prop("checked")?($("#startScale").prop("disabled",!1),$("#endScale").prop("disabled",!1),$("#manualScaleInputArea").slideDown()):($("#startScale").prop("disabled",!1),$("#endScale").prop("disabled",!1),$("#manualScaleInputArea").slideUp())}function checkBS(){$("#noNetworkBS").prop("checked")?($("#numBootStrapping").prop("disabled",!0),$("#numBSArea").slideUp()):($("#numBootStrapping").prop("disabled",!1),$("#numBSArea").slideDown())}function checkComplex(){$("#noComplexBS").prop("checked")?$("#complexBSArea").slideUp():$("#complexBSArea").slideDown()}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function checkSourceData(){var e=$("#organism").val().split("_").splice(0,2),i=capitalize(e[0])+" "+e[1].toLowerCase(),n=$("#interactionDataOrganism").val(),t="";$("#organism").val().match(/biogrid/i)?t="BioGRID":$("#organism").val().match(/droiDB/i)&&(t="droiDB"),""!=t?i!=n||$('#interactions:contains("Error!")').length>0?($.ajax({url:"clik/update_interactions/",data:"organism="+e[0].charAt(0)+e[1]+"&db="+t,success:function(e){e.hasOwnProperty("error")?$("#interactions").html('<div class="alert">Error! '+e.error+"</div>"):$("#interactions").html(e)},error:function(){$("#interactions").html('<div class="alert">Error! could not load interaction data.</div>')},complete:function(){$("#interactions").is(":visible")?$("#interactions").effect("highlight",{},1e3):$("#interactions").slideDown()}}),$("#interactionDataOrganism").val(i)):$("#interactions").is(":visible")||$("#interactions").slideDown():$("#interactions").is(":visible")&&$("#interactions").slideUp();var r="";i.match(/sapien/i)?r='<div id="idSelector"><label for="idType" style="display:inline;">Gene ID type:</label><select name="idType" id="idType"><option value="ensembl">Ensembl Gene IDs</option><option value="geneName">Gene Names</option></select></div>':i.match(/melanogaster/i)?r='<div id="idSelector"><label for="idType" style="display:inline;">Gene ID type:</label>FlyBase IDs only!</div>':i.match(/pombe/i)&&(r='<div id="idSelector"><label for="idType" style="display:inline;">Gene ID type:</label>Pombe systematic IDs only (e.g. <em>SPBC11B10.09</em>)!</div>'),i.match(/cerevisiae/i)?($("#complexSource").slideDown(),$("#screenMillFileContainer").slideDown(),$("#idSelector").remove()):($("#screenMillFileContainer").slideUp(100,function(){$("#idSelector").length<1&&$("#idsInputContainer").append(r)}),$("#complexSource").is(":visible")&&$("#complexSource").slideUp())}function alltrim(e){return e.replace(/^\s+|\s+$/g,"")}function validate(){if(numberOfPings=0,$("#results").hide(),$("#results")[0].src="",$(".error").remove(),$("#dummyFrame").contents().find("body").html(""),$("#dummyFrame").contents().find("title").length>0&&$("#dummyFrame").contents().find("title").html(""),$("#pingError").html(""),$("#pingError").fadeOut(),$("#sessionID").val(getRand()),$("#rankError")&&$("#rankError").remove(),$("#checkError")&&$("#checkError").remove(),$("#numberIDsError")&&$("#numberIDsError").remove(),$("#formError")&&$("#formError").remove(),""==$("#ids").val()&&""==$("#millFile").val()){var e='<div class="validation-advice" id="rankError">You must enter some data to analyze...</div>';$("#rankData").prepend(e)}else if(""!=$("#ids").val()){var i=$("#ids").val().split(/\r|,|\n|,\s+|\s+|\|/);if(i=$.grep(i,function(e){return e&&""!=e?e:void 0}).length,50>i){var e='<div class="validation-advice" id="numberIDsError">';e+="You must enter more than 50 elements in order for this program to run...</div>",$("#rankData").prepend(e)}}if($("#manualScale").prop("checked")){var n=alltrim($("#startScale").val()),t=alltrim($("#endScale").val());if(""!=n&&""!=t&&/^[-+]?[0-9]+(\.[0-9]+)?$/.test(n)&&/^[-+]?[0-9]+(\.[0-9]+)?$/.test(t)){if(n>=t){var e='<div class="validation-advice" id="numberIDsError">The start value must be less than the end value</div>';$("#manualScaleInputArea").prepend(e)}}else{var e='<div class="validation-advice" id="numberIDsError">To use the manual scale you';e+="must enter valid decimal numbers (e.g. 0.02, 1, 1.5)...</div>",$("#manualScaleInputArea").prepend(e)}}if($("#clikForm :checkbox:checked").length<1){var e='<div class="validation-advice" id="checkError">You must check at least one type of interaction...</div>';$("#interactions").prepend(e),window.scrollTo(0,0)}var r=$(".validation-advice").length;if(r>0){var o=1==r?["A error","error is"]:["Errors","errors are"],e='<div class="validation-advice" style="float:left;clear:left;" id="formError">';return e+=o[0]+" above prevented the form from being submitted. If the "+o[1]+" not visible, please scroll up to view them.<br/></div>",$("#submitContainer").prepend(e),!1}return $("#loading").fadeIn(),$("#spinner").fadeIn(),$("#trough").fadeIn(),$("#message").html(""),$("#bar").width("0%"),$("#progress-div").css("display","block"),setTimeout("ping()",2e3),!0}function ping(){$("message").html()==lastPingMsg?numberOfPings+=1:numberOfPings=0;var e=new XMLHttpRequest,i=!0;e.onreadystatechange=function(){if(4==e.readyState){if(200!=e.status)return loadingError(),!1;"finished!"!=e.responseText?parse(e.responseText):($("#message").html("Done! (100%)"),$("#bar").width("100%"),i=!1)}},i&&(e.open("GET","/tools/cgi-bin/pingScript.cgi?&sessionID="+$("#sessionID").val(),!0),e.send(null))}function iFrameLoad(){$("#conditionCombo").val(""),$("#conditionCombo1").length<1&&($("#results")[0].src.indexOf("images")>0||$("#results")[0].contentWindow.document.body.innerHTML.indexOf("clikError")>0)&&($("#results").show(),calcHeight(),calcHeight())}function parse(e){if(e.indexOf(":hideMe")>0&&($("#message").html(""),$("#loading").fadeOut()),e.indexOf("combos:")>0){$("#spinner").fadeOut(),$("#trough").fadeOut(),$("#loading").fadeIn();var n="Multiple query-condition combinations found in the file you uploaded. Please select the one you would like to analyze and then click the re-submit button.";n+="<br/><select class='field_associates' name='conditionCombo1' id='conditionCombo1' style='padding:5px;'>";var t=e.split(":");for(i=2;i<t.length;i++){var r=t[i].gsub(/\t/,"-");r=t[i].gsub(/\s/,""),n=n+"<option value="+r+">"+t[i]+"</option>"}n+="</select><button onclick='reSubmitForm();'  />Re-Submit</button>",$("#message").html(n)}else{var t=e.split(":");if("printToBrowserExit"==t[0])document.getElementById("results").src="temp/images/"+t[1]+"/"+$("#sessionID").val()+".html",$("#loading").fadeOut("fast",function(){iFrameLoad("")});else if(2==t.length){if(-1==t[1].indexOf("error")&&$("#loading").is(":visible")){if($("#dummyFrame").contents().find('body:contains("500 error"),title:contains("500")').length>0||"printGenericError"==t[1])return loadingError(),!1;setupPing()}$("#message").html(t[1]),$("#bar").width(t[0]+"%")}else setupPing()}return lastPingMsg=$("#message").html(),!0}function loadingError(){return $("#loading").hide(0,function(){var e='<div class="error" style="margin-top:10px;color:red;float:left;clear:left;" id="error">';e+="A error occurred when running CLIK. Please <a style='display:inline;' href='mailto:admin@rothsteinlab.com'>contact the administrator.</a><br/></div>",$("#submitContainer").append(e)}),!1}function setupPing(){$("#results")[0].contentWindow.document.body.innerHTML.indexOf("clikError")>0||$("#results")[0].src.indexOf("images")>0&&$("#results")[0].contentWindow.document.body.innerHTML.length>5&&$("#results").is(":visible")?$("#loading").fadeOut():numberOfPings>200?($("#loading").fadeOut(),$("#pingError").html("CLIK Timeout Error! please try again later. If you receive this message repeatidly, please contact an administrator."),$("#pingError").fadeIn()):setTimeout("ping()",2e3)}function calcHeight(){$("#results").length>0&&$("#results")[0].contentWindow.document.body&&$("#results").height($("#results")[0].contentWindow.document.body.scrollHeight)}function reSubmitForm(){return $("#sessionID").val(getRand()),$("#conditionCombo").val($("#conditionCombo1").val()),setTimeout("doNothing()",1e3),$("#clikForm")[0].action="/tools/cgi-bin/clik.cgi",!0}function getRand(){return Math.random().toString(36).substring(2,7)+""+(new Date).getTime()}function doNothing(){return!0}function checkDummyContentOnLoad(){return $("#dummyFrame")[0].contentWindow.location.pathname.indexOf("clik.cgi")>0?$("#dummyFrame").contents().find('body:contains("so far, so good")').length>0?!0:($("#dummyFrame").contents().find("body").html("500 error"),!1):!0}var numberOfPings=0,lastPingMsg="";$(document).ready(function(){checkDensity(),checkBS(),checkComplex(),checkSourceData(),$("#organism").change(function(){checkSourceData()})});