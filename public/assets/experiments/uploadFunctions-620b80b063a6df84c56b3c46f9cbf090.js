function checkUploadButtons(){$("input[name=uploadMe]:checked").length>0?$(".submitDiv").fadeIn():$(".submitDiv").fadeOut()}function setupUploadData(){$("#progress-success").prop("title","0");var s=$("input[name=uploadMe]:checked");return setupLoadingProgress(function(){uploadData(s,0)})}function progress(s,e){var o=s*e.width()/100;e.find("div").animate({width:o},500).html(s+"%&nbsp;")}function setupLoadingProgress(s){$("#progress-success").html(""),$("#progress-success").hide(),$("#progress-errors").hide(),$("#progress-errors ul").html(""),$("#loading-dialog").dialog({height:150,width:455,modal:!0,autoOpen:!1,show:"slow",hide:"explode",draggable:!1,dialogClass:"no-title curvy"}),progress(0,$("#progressBar")),$("#progressBar").css("display","block"),$("#loading-dialog").dialog("option","buttons",[]),$("#loading-dialog").dialog("open"),$("#progressBar").css("width",$("#loading-dialog").width()-5),s()}function uploadData(s,e){if(void 0===e&&(e=0),e>=s.length){$("#loading-dialog").effect("highlight"),progress(100,$("#progressBar")),setTimeout(function(){$("#progressBar").effect("fade",{},750,function(){$("#loading-dialog").dialog("option","buttons",[{text:"Ok",click:function(){$(this).dialog("close")}}])})},500);var o=$("#loading-dialog").dialog("option","height");return $("#loading-dialog").dialog("option","height",o+50),$("#loading-message").html("Finished! Review the messages below and then click 'Ok' to close this window"),void 0}var r=s[e],t=$(r).val(),a=buildData(t);$.ajax({type:"POST",url:script,data:$(a.form).serialize(),dataType:"json",beforeSend:function(){$("#loading-message").html("Now Processing "+a.setInfo+" ("+(e+1)+" of "+s.length+")")},success:function(s){if(s)if(s.hasOwnProperty("errorMsg"))$("#progress-errors").show(),"string"!=typeof s.errorMsg&&(s.errorMsg=s.errorMsg.join(", ")),$("#progress-errors ul").append("<li><strong>"+s.dataSet+":</strong> "+s.errorMsg+"</li>");else{updateRow("success",s.rowNum);var e=parseInt($("#progress-success").prop("title"))+1;$("#progress-success").html("<strong>"+modalSuccessMsg+" <span>"+e+"</span> datasets.</strong>"),$("#progress-success").prop("title",e),$("#progress-success").show()}else $("#progress-errors").show(),$("#progress-errors ul").append("<li>An error occurred server-side. Contact the admin for assistance.</li>")},error:function(){$("#progress-errors").show(),$("#progress-errors ul").append("<li>"+a.setInfo+": an error occurred server-side. Contact the admin for assistance.</li>")},complete:function(){e+=1,progress(Math.round(100*(e/s.length)),$("#progressBar")),uploadData(s,e),checkUploadButtons()}})}function updateRow(s,e){$(".rowNum"+e).each(function(){return $(this).hasClass("fileNameRow")?!0:($(this).addClass(s),$(this).removeClass("badData"),"success"==s&&$(this).children().each(function(s,e){$(e).unbind(),$(e).removeClass("badData"),($(e).is("select")||$(e).is("input")||$(e).is("textarea")||$(e).is("button"))&&$(e).prop("disabled","disabled")}),void 0)}),"success"==s&&$("#uploadTD"+e).html("<strong>"+successMsg+"</strong>")}var modalSuccessMsg="Successfully uploaded",successMsg="Success!";"undefined"!=typeof customModalMsg&&(modalSuccessMsg=customModalMsg),"undefined"!=typeof customSuccessMsg&&(successMsg=customSuccessMsg);